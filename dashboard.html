<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OHA</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><rect width='16' height='16' fill='%230a0a0a'/><rect x='4' y='2' width='8' height='12' fill='%23FFD700'/><rect x='5' y='4' width='6' height='8' fill='%23FF8C00'/><rect x='6' y='6' width='4' height='4' fill='%238B1A1A'/></svg>">
    <meta name="description" content="Open Heat Amsterdam - Interactive building heat readiness dashboard">
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <!-- Dashboard Styles -->
    <link rel="stylesheet" href="dashboard.css">
</head>
<body>
    <!-- Map Container -->
    <div id="map"></div>
    
    <!-- Search Bar -->
    <div id="search-container" class="search-container">
        <input type="text" id="address-search" class="search-input" placeholder="Search address...">
        <div id="search-results" class="search-results hidden"></div>
    </div>
    
    <!-- ================================================================ -->
    <!-- SIDE PANEL: Configuration & Building Details                     -->
    <!-- ================================================================ -->
    <div id="side-panel" class="side-panel">
        <!-- Panel Header -->
        <div class="panel-header">
            <h2 id="panel-title">Configuration</h2>
            <button id="back-to-heatmap" class="back-btn hidden">← Back</button>
        </div>
        
        <!-- Heatmap Configuration View -->
        <div id="heatmap-view" class="panel-content">
            <!-- Instructions -->
            <div class="config-intro">
                <p>Weight the building characteristics below to generate a heat vulnerability heatmap. Weights must sum to 1.0 or less, then press <strong>Apply</strong>.</p>
            </div>
            
            <div class="config-intro">
                <p>Aggregate scores by neighbourhood with <span class="text-regional">Regional Heatmap</span>. View <span class="text-lst">Land Surface Temperature</span> at 1km resolution.</p>
            </div>
            
            <!-- Energy Label Filter -->
            <div class="control-section">
                <label class="control-label">Energy Label</label>
                <div class="filter-row">
                    <select id="energy-operator" class="filter-select">
                        <option value="<=" selected>≤</option>
                        <option value=">=">≥</option>
                    </select>
                    <select id="energy-value" class="filter-select">
                        <option value="A">A</option>
                        <option value="B">B</option>
                        <option value="C" selected>C</option>
                        <option value="D">D</option>
                        <option value="E">E</option>
                        <option value="F">F</option>
                        <option value="G">G</option>
                    </select>
                </div>
                <label class="control-label">
                    Weight <span id="energy-weight-value">0.33</span>
                </label>
                <input type="range" id="energy-weight" min="0" max="1" step="0.01" value="0.33" class="slider">
                <p class="help-text">Binary: matches criteria = 1.0, else 0.0</p>
            </div>
            
            <!-- Building Year Filter -->
            <div class="control-section">
                <label class="control-label">Building Year</label>
                <div class="filter-row">
                    <select id="year-operator" class="filter-select">
                        <option value="<=">≤</option>
                        <option value=">=" selected>≥</option>
                    </select>
                    <input type="number" id="year-value" class="filter-input" value="1900" min="1600" max="2024">
                </div>
                <label class="control-label">
                    Weight <span id="year-weight-value">0.33</span>
                </label>
                <input type="range" id="year-weight" min="0" max="1" step="0.01" value="0.33" class="slider">
                <p class="help-text">Binary: matches criteria = 1.0, else 0.0</p>
            </div>
            
            <!-- Busy Road Filter -->
            <div class="control-section">
                <label class="control-label">
                    Busy Road <span id="busy-road-weight-value">0.33</span>
                </label>
                <input type="range" id="busy-road-weight" min="0" max="1" step="0.01" value="0.33" class="slider">
                <p class="help-text">Binary: on busy road = 1.0, else 0.0</p>
            </div>
            
            <div class="weight-summary">
                <strong>Total</strong> <span id="total-weight">1.00</span>
                <span id="weight-warning" class="warning hidden">Must be ≤ 1.0</span>
            </div>
            
            <button id="apply-heatmap" class="apply-btn">Apply</button>
            
            <!-- Regional Heatmap -->
            <div class="feature-section">
                <button id="regional-heatmap-btn" class="feature-btn regional-btn">Regional Heatmap</button>
                <div id="regional-opacity-container" class="opacity-container hidden">
                    <input type="range" id="regional-opacity" min="0" max="1" step="0.05" value="0.7" class="slider opacity-slider">
                    <span id="regional-opacity-value" class="opacity-value">70%</span>
                </div>
            </div>
            
            <!-- Land Surface Temperature -->
            <div class="feature-section">
                <div class="feature-buttons">
                    <button id="dlst-2024-btn" class="feature-btn lst-btn" data-year="2024">LST 2024</button>
                    <button id="dlst-2025-btn" class="feature-btn lst-btn" data-year="2025">LST 2025</button>
                </div>
                <div id="dlst-opacity-container" class="opacity-container hidden">
                    <input type="range" id="dlst-opacity" min="0" max="1" step="0.05" value="0.7" class="slider opacity-slider">
                    <span id="dlst-opacity-value" class="opacity-value">70%</span>
                </div>
                <p class="help-text">Average summer temperature (May-Sep)</p>
            </div>
        </div>
        
        <!-- Building Details View -->
        <div id="building-view" class="panel-content hidden">
            <div id="building-content"></div>
        </div>
    </div>
    
    <!-- ================================================================ -->
    <!-- LOADING SCREEN: Pixel Grid Animation                             -->
    <!-- ================================================================ -->
    <div id="loading" class="loading-screen">
        <div class="loading-content">
            <div class="grid-text"></div>
        </div>
    </div>
    
    <!-- ================================================================ -->
    <!-- SCRIPTS                                                           -->
    <!-- ================================================================ -->
    <!-- Leaflet.js -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <!-- Neighborhood GeoJSON -->
    <script src="neighborhoods.js"></script>
    
    <!-- Application -->
    <script src="app.js"></script>
</body>
</html>

